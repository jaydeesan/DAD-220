SELECT COUNT(*) AS TOTAL_RETURNED, Orders.SKU AS PRODUCT_SKU, Customer.State, RMA.Reason 
	FROM RMA INNER JOIN Orders ON Orders.ORDERID = RMA.ORDERID 
	JOIN Customer ON Customer.CUSTOMERID = Orders.CUSTOMERID 
	GROUP BY Customer.State 
	ORDER BY TOTAL_RETURNED DESC 
	LIMIT 10;


SELECT COUNT(*) AS TOTAL_RETURNED, Orders.SKU AS PRODUCT_SKU, RMA.Reason 
	FROM RMA INNER JOIN Orders ON Orders.ORDERID = RMA.ORDERID 
	GROUP BY PRODUCT_SKU
	ORDER BY TOTAL_RETURNED DESC 
	LIMIT 10;

SELECT RMA.Reason AS Reason, COUNT(*) * 100.0/(SELECT COUNT(*) FROM RMA) AS Percentage 
	FROM RMA INNER JOIN Orders On Orders.ORDERID = RMA.ORDERID 
	GROUP BY REASON 
	ORDER BY Percentage DESC 
	LIMIT 10;

SELECT Orders.SKU AS SKU, COUNT(*) * 100.0 / (SELECT COUNT(*) FROM RMA) AS Percentage 
	FROM RMA INNER JOIN Orders ON Orders.ORDERID = RMA.ORDERID 
	GROUP BY SKU 
	ORDER BY Percentage DESC 
	;